<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard | Subjects_666</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg: #0b0f1a; --panel: #161b22; --accent: #00ff88; --border: rgba(255,255,255,0.1); }
        body { margin: 0; background: var(--bg); color: white; font-family: sans-serif; display: flex; }
        aside { width: 250px; background: #0d1117; height: 100vh; padding: 30px; border-right: 1px solid var(--border); }
        main { flex: 1; padding: 40px; overflow-y: auto; }
        .card { background: var(--panel); border-radius: 20px; padding: 25px; border: 1px solid var(--border); margin-bottom: 25px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: left; opacity: 0.5; padding: 15px; border-bottom: 1px solid var(--border); }
        td { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .btn-detail { background: none; border: none; color: var(--accent); cursor: pointer; font-size: 1.5rem; transition: 0.3s; }
        .btn-detail:hover { transform: translateX(5px); }
        /* Modal */
        #modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:100; align-items:center; justify-content:center; }
        .modal-content { background: var(--panel); padding: 40px; border-radius: 30px; width: 500px; border: 1px solid var(--accent); }
        input { background: #0b0f1a; border: 1px solid var(--border); padding: 12px; border-radius: 10px; color: white; width: 100%; margin: 10px 0; }
        .btn-save { background: var(--accent); color: black; border: none; padding: 12px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; }
    </style>
</head>
<body>
    <aside>
        <h2 style="color:var(--accent)">SUBJECTS_666</h2>
        <p>TÜBİTAK Proje Paneli</p>
    </aside>
    <main>
        <div class="card">
            <h3>Yeni Duygu/Kelime Ekle</h3>
            <div style="display:flex; gap:10px;">
                <input type="text" id="in-name" placeholder="Kelime (Örn: Happiness)">
                <input type="text" id="in-img" placeholder="Görsel URL">
                <button class="btn-save" style="width:auto; padding:0 30px;" onclick="addWord()">Ekle</button>
            </div>
        </div>
        <div class="card">
            <table>
                <thead><tr><th>KELİME</th><th>İSTATİSTİK</th><th>ANALİZ</th><th>İŞLEM</th></tr></thead>
                <tbody id="list"></tbody>
            </table>
        </div>
    </main>

    <div id="modal">
        <div class="modal-content">
            <h2 id="m-title">Analiz</h2>
            <canvas id="m-chart" style="max-height: 200px; margin-bottom: 20px;"></canvas>
            <input type="text" id="m-name" placeholder="Kelimeyi Düzenle">
            <input type="text" id="m-img" placeholder="Görsel URL Düzenle">
            <button class="btn-save" onclick="saveEdit()">Değişiklikleri Kaydet</button>
            <button onclick="document.getElementById('modal').style.display='none'" style="background:none; border:none; color:white; margin-top:15px; cursor:pointer; width:100%">Kapat</button>
        </div>
    </div>

    <script>
        // Örnek Verilerle Başlat (Kırık görüntü olmaması için)
        let data = JSON.parse(localStorage.getItem('subjectWords')) || [
            { id: 1, name: 'Happiness', img: 'https://images.unsplash.com/photo-1527631746610-bca00a040d60?w=500', hits: 12, tries: 15 },
            { id: 2, name: 'Surprise', img: 'https://images.unsplash.com/photo-1530268582393-51475937155d?w=500', hits: 5, tries: 10 }
        ];

        function render() {
            const list = document.getElementById('list');
            list.innerHTML = '';
            data.forEach(w => {
                let perc = w.tries > 0 ? Math.round((w.hits/w.tries)*100) : 0;
                list.innerHTML += `<tr>
                    <td><strong>${w.name}</strong></td>
                    <td>${w.hits} Başarı / %${perc} Skor</td>
                    <td><button class="btn-detail" onclick="openModal(${w.id})">➔</button></td>
                    <td><button onclick="del(${w.id})" style="color:#ff4d4d; background:none; border:none; cursor:pointer">Sil</button></td>
                </tr>`;
            });
            localStorage.setItem('subjectWords', JSON.stringify(data));
        }

        function addWord() {
            const n = document.getElementById('in-name').value;
            const i = document.getElementById('in-img').value;
            if(!n) return;
            data.push({ id: Date.now(), name: n, img: i || 'https://via.placeholder.com/500x300?text=Gorsel+Yok', hits: 0, tries: 0 });
            render();
        }

        let curId = null; let chart = null;
        function openModal(id) {
            curId = id; const w = data.find(x => x.id === id);
            document.getElementById('m-title').innerText = w.name + " Verileri";
            document.getElementById('m-name').value = w.name;
            document.getElementById('m-img').value = w.img;
            document.getElementById('modal').style.display = 'flex';
            const ctx = document.getElementById('m-chart').getContext('2d');
            if(chart) chart.destroy();
            chart = new Chart(ctx, { type: 'doughnut', data: { labels: ['Başarı', 'Hata'], datasets: [{ data: [w.hits, w.tries - w.hits], backgroundColor: ['#00ff88', '#ff4d4d'] }] } });
        }

        function saveEdit() {
            const w = data.find(x => x.id === curId);
            w.name = document.getElementById('m-name').value;
            w.img = document.getElementById('m-img').value;
            render(); document.getElementById('modal').style.display = 'none';
        }

        function del(id) { data = data.filter(x => x.id !== id); render(); }
        render();
    </script>
</body>
</html>
